<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ActorFramework: ActorFramework/include/ExecutionUnit.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ActorFramework
   </div>
   <div id="projectbrief">Basic implementation of the actor framework using MPI</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3653351438fe4517e23a6c78debfdd84.html">ActorFramework</a></li><li class="navelem"><a class="el" href="dir_9c426c0ac6187fe359653f40240549cd.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ExecutionUnit.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef ACTOR_FRAMEWORK_EXECUTION_UNIT_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define ACTOR_FRAMEWORK_EXECUTION_UNIT_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;Actor.h&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;Message.h&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;mpi.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">namespace </span>ActorFramework {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keyword">class </span>Actor;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="classActorFramework_1_1ExecutionUnit.html">   24</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classActorFramework_1_1ExecutionUnit.html">ExecutionUnit</a> {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="classActorFramework_1_1ExecutionUnit.html#a1e28737d29646c63879f4e1b6ddb6e21">   30</a></span>&#160;        <a class="code" href="classActorFramework_1_1ExecutionUnit.html#a1e28737d29646c63879f4e1b6ddb6e21">ExecutionUnit</a>();</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classActorFramework_1_1ExecutionUnit.html#a15ff932f2bec2d81e6ac13998eef966f">   45</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classActorFramework_1_1ExecutionUnit.html#a15ff932f2bec2d81e6ac13998eef966f">createNewActor</a>(<a class="code" href="classActorFramework_1_1Message.html">Message</a> &amp;message, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *createdActorId = <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="classActorFramework_1_1ExecutionUnit.html#a0871ee7068b843ff4c7c0f104b65fc42">   53</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classActorFramework_1_1ExecutionUnit.html#a0871ee7068b843ff4c7c0f104b65fc42">finishProgram</a>();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classActorFramework_1_1ExecutionUnit.html#a7d5a1f209dacaa014a2410ecd575a60b">   65</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classActorFramework_1_1ExecutionUnit.html#a7d5a1f209dacaa014a2410ecd575a60b">communicateWithActor</a>(<a class="code" href="classActorFramework_1_1Message.html">Message</a> &amp;message) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classActorFramework_1_1ExecutionUnit.html#adabb7ff8b6bbc1cdd80315e2d8e6c225">   73</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classActorFramework_1_1ExecutionUnit.html#adabb7ff8b6bbc1cdd80315e2d8e6c225">mainLoop</a>();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    </div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classActorFramework_1_1ExecutionUnit.html#a383f23f9c1c4e0e8aa83fb0fb8ca3a14">   82</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classActorFramework_1_1ExecutionUnit.html#a383f23f9c1c4e0e8aa83fb0fb8ca3a14">registerActorType</a>(<a class="code" href="classActorFramework_1_1Actor.html">Actor</a> *actor);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classActorFramework_1_1ExecutionUnit.html#a4635d5264e6049af5787973676db3dee">   91</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classActorFramework_1_1ExecutionUnit.html#a4635d5264e6049af5787973676db3dee">destroyActor</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> actorId_);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="classActorFramework_1_1ExecutionUnit.html#a9fc237f16fc7a1eb97ef15b7ef3f02e3">   99</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classActorFramework_1_1ExecutionUnit.html#a9fc237f16fc7a1eb97ef15b7ef3f02e3">getRank</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> rank; }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classActorFramework_1_1ExecutionUnit.html#adf6674f19b0ef25a0220747f0154ecef">  107</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classActorFramework_1_1ExecutionUnit.html#adf6674f19b0ef25a0220747f0154ecef">isMaster</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> masterExecutioner; }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> MASTER_RANK = 0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> MPI_Comm comm = MPI_COMM_WORLD;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordtype">int</span> rank;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordtype">int</span> size;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newActorId;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordtype">bool</span> masterExecutioner;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        std::map&lt;unsigned int, Actor *&gt; localActors;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        std::map&lt;unsigned int, int&gt; actorIdToExecutionRank;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        std::vector&lt;unsigned int&gt; executionUnitsLoadBalance;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        std::vector&lt;Actor *&gt; templateActors;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">void</span> checkAndProcessMessages(<span class="keyword">const</span> <span class="keywordtype">bool</span> activeActors);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordtype">void</span> processMessage(<a class="code" href="classActorFramework_1_1Message.html">Message</a> &amp;message);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordtype">void</span> processMessageCreateNewActor(<a class="code" href="structActorFramework_1_1Message_1_1MessageData.html">Message::MessageData</a> *messageData);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordtype">void</span> processMessageDeleteActor(<a class="code" href="structActorFramework_1_1Message_1_1MessageData.html">Message::MessageData</a> *messageData);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">void</span> processMessageStop();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordtype">void</span> processMessageCommunication(<span class="keyword">const</span> <span class="keywordtype">int</span> messageSize, <a class="code" href="classActorFramework_1_1Message.html">Message</a> &amp;message);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordtype">bool</span> updateActors();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordtype">void</span> cleanDeletedProcesses();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordtype">void</span> sendMessage(<span class="keyword">const</span> <span class="keywordtype">int</span> destExecutionUnit, <a class="code" href="classActorFramework_1_1Message.html">Message</a> &amp;message, MPI_Request *req) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordtype">void</span> recvMessage(MPI_Status &amp;status);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    };</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}<span class="comment">// ActorFramework</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">#endif</span><span class="comment">//ACTOR_FRAMEWORK_EXECUTION_UNIT_H</span></div>
<div class="ttc" id="aclassActorFramework_1_1Actor_html"><div class="ttname"><a href="classActorFramework_1_1Actor.html">ActorFramework::Actor</a></div><div class="ttdoc">This is the main class of the program. Actors will be in charge of executing the simulation....</div><div class="ttdef"><b>Definition:</b> Actor.h:25</div></div>
<div class="ttc" id="aclassActorFramework_1_1ExecutionUnit_html"><div class="ttname"><a href="classActorFramework_1_1ExecutionUnit.html">ActorFramework::ExecutionUnit</a></div><div class="ttdoc">Execution units are in charge of processing all the actors. When an actor is created it should be ass...</div><div class="ttdef"><b>Definition:</b> ExecutionUnit.h:24</div></div>
<div class="ttc" id="aclassActorFramework_1_1ExecutionUnit_html_a0871ee7068b843ff4c7c0f104b65fc42"><div class="ttname"><a href="classActorFramework_1_1ExecutionUnit.html#a0871ee7068b843ff4c7c0f104b65fc42">ActorFramework::ExecutionUnit::finishProgram</a></div><div class="ttdeci">void finishProgram()</div><div class="ttdoc">Send a termination message to all execution units completing the program. This is similar to a force ...</div></div>
<div class="ttc" id="aclassActorFramework_1_1ExecutionUnit_html_a15ff932f2bec2d81e6ac13998eef966f"><div class="ttname"><a href="classActorFramework_1_1ExecutionUnit.html#a15ff932f2bec2d81e6ac13998eef966f">ActorFramework::ExecutionUnit::createNewActor</a></div><div class="ttdeci">void createNewActor(Message &amp;message, unsigned int *createdActorId=nullptr)</div><div class="ttdoc">Creates a New Actor object on the less loaded execution unit. First sends a message to the master whi...</div></div>
<div class="ttc" id="aclassActorFramework_1_1ExecutionUnit_html_a1e28737d29646c63879f4e1b6ddb6e21"><div class="ttname"><a href="classActorFramework_1_1ExecutionUnit.html#a1e28737d29646c63879f4e1b6ddb6e21">ActorFramework::ExecutionUnit::ExecutionUnit</a></div><div class="ttdeci">ExecutionUnit()</div><div class="ttdoc">Construct a new Execution Unit object.</div></div>
<div class="ttc" id="aclassActorFramework_1_1ExecutionUnit_html_a383f23f9c1c4e0e8aa83fb0fb8ca3a14"><div class="ttname"><a href="classActorFramework_1_1ExecutionUnit.html#a383f23f9c1c4e0e8aa83fb0fb8ca3a14">ActorFramework::ExecutionUnit::registerActorType</a></div><div class="ttdeci">unsigned int registerActorType(Actor *actor)</div><div class="ttdoc">Register a new type of actors that can be created. Must be called on all execution units.</div></div>
<div class="ttc" id="aclassActorFramework_1_1ExecutionUnit_html_a4635d5264e6049af5787973676db3dee"><div class="ttname"><a href="classActorFramework_1_1ExecutionUnit.html#a4635d5264e6049af5787973676db3dee">ActorFramework::ExecutionUnit::destroyActor</a></div><div class="ttdeci">void destroyActor(const unsigned int actorId_)</div><div class="ttdoc">Destroys one actor Depending of the warning level new messages send to this actor will be ignored or ...</div></div>
<div class="ttc" id="aclassActorFramework_1_1ExecutionUnit_html_a7d5a1f209dacaa014a2410ecd575a60b"><div class="ttname"><a href="classActorFramework_1_1ExecutionUnit.html#a7d5a1f209dacaa014a2410ecd575a60b">ActorFramework::ExecutionUnit::communicateWithActor</a></div><div class="ttdeci">void communicateWithActor(Message &amp;message) const</div><div class="ttdoc">Send a message to an actor. It communicates with other execution units. Error handle allows to redire...</div></div>
<div class="ttc" id="aclassActorFramework_1_1ExecutionUnit_html_a9fc237f16fc7a1eb97ef15b7ef3f02e3"><div class="ttname"><a href="classActorFramework_1_1ExecutionUnit.html#a9fc237f16fc7a1eb97ef15b7ef3f02e3">ActorFramework::ExecutionUnit::getRank</a></div><div class="ttdeci">int getRank() const</div><div class="ttdoc">Gets the Rank or id of the execution unit. When using the MPI implementation is the same as calling M...</div><div class="ttdef"><b>Definition:</b> ExecutionUnit.h:99</div></div>
<div class="ttc" id="aclassActorFramework_1_1ExecutionUnit_html_adabb7ff8b6bbc1cdd80315e2d8e6c225"><div class="ttname"><a href="classActorFramework_1_1ExecutionUnit.html#adabb7ff8b6bbc1cdd80315e2d8e6c225">ActorFramework::ExecutionUnit::mainLoop</a></div><div class="ttdeci">void mainLoop()</div><div class="ttdoc">Starts the program. The execution unit will be on an infinite loop to update and receive actors messa...</div></div>
<div class="ttc" id="aclassActorFramework_1_1ExecutionUnit_html_adf6674f19b0ef25a0220747f0154ecef"><div class="ttname"><a href="classActorFramework_1_1ExecutionUnit.html#adf6674f19b0ef25a0220747f0154ecef">ActorFramework::ExecutionUnit::isMaster</a></div><div class="ttdeci">bool isMaster() const</div><div class="ttdoc">Gets if the execution unit is the master.</div><div class="ttdef"><b>Definition:</b> ExecutionUnit.h:107</div></div>
<div class="ttc" id="aclassActorFramework_1_1Message_html"><div class="ttname"><a href="classActorFramework_1_1Message.html">ActorFramework::Message</a></div><div class="ttdoc">Messages are shared between different execution units for internal and intra-actor communication.</div><div class="ttdef"><b>Definition:</b> Message.h:20</div></div>
<div class="ttc" id="astructActorFramework_1_1Message_1_1MessageData_html"><div class="ttname"><a href="structActorFramework_1_1Message_1_1MessageData.html">ActorFramework::Message::MessageData</a></div><div class="ttdoc">Message send between actor.</div><div class="ttdef"><b>Definition:</b> Message.h:60</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
